---
layout:     post
title: 	    "Blog: Fotosjov med exiftool på Linux-kommandolinjen"
post_author:	    Peter Toft
post_date:	    Sun, 15 Mar 2015 22:29:00 +0000
post_site:	    www.version2.dk 
post_link:	    http://www.version2.dk/blog/fotosjov-med-exiftool-paa-linux-kommandolinjen-102625?utm_medium=feed&utm_source=version2.dk&utm_campaign=it_nyheder
---
<html><body><div><section class="body"><p>Det sker fra tid til anden at jeg er ude og fotografere. Det synes jeg at sjovt, og jeg er en glad amatør :-)
Jeg ved også at det jeg har sværest ved at fotografere godt er indendørs karate-stævner. Der er ofte dårligt lys, og jeg må ikke bruge blitz når jeg "skyder" de unge i kamp.
I går fik jeg taget 1645 billeder med tre forskellige objektiver, og i dag er det lidt sjovt at lave lidt status på billederne.
Hvor meget brugte jeg de forskellige objektiver og hvor tæt fokuserede jeg i praksis? 
Det er oplagt at jeg kan bruge den type informationer til at vælge objektiver fremadrettet.
Det er vist en dødsejler, at få overblik over så mange billeder på Windows, men på en Linux-maskine med lidt kommandolinie-gymnatisk er det ret nemt. Jeg giver et par eksempler på dette og niveauet bliver meget "hands-on".</p>

<p>Til at kigge status på billederne er "exiftool" et meget enkelt værktøj til at se information om hvert billede. 
På et billede f.eks. DSC_2681.JPG er det nemt at se data</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">$ exiftool DSC_2681.JPG <span>|</span> <span>wc</span> <span>--lines</span>
<span>190</span></pre></div>

<p>For hvert billede taget med mit Nikon D3100 kamera er der således 190 linier gemt med information om dato, billed-størrelse, åbningstid, fokus, objektiv-data osv. 
Den nemmeste måde at se hvilke information der findes er at pipe informationerne over i "less" og bruge op og ned pil til at gå frem og tilbage (og "q" for at afslutte)</p>

<div class="geshifilter"><pre class="bash geshifilter-bash"><span>$ </span>exiftool DSC_2681.JPG <span>|</span> <span>less</span></pre></div>

<p>F.eks. kan jeg finde et par linier med objektiv-information</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">Lens ID                         : AF-S VR Zoom-Nikkor <span>24</span>-85mm f<span>/</span><span>3.5</span>-4.5G IF-ED
Lens                            : <span>24</span>-85mm f<span>/</span><span>3.5</span>-<span>4.5</span> G VR</pre></div>

<p>For at hvilke objektiver jeg bruge mest så er det nemt nok. Exittool kaldes med alle Jpeg billeder (*.JPG) og grep bruges til at tage de linier ud der indeholder "Lens ID". Sorter linierne og med "uniq -c"
vises hvor mange linier, som har de enkelte tekster.</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">$ exiftool <span>*</span>.JPG <span>|</span> <span>grep</span> <span>"Lens ID  "</span> <span>|</span> <span>sort</span> <span>|</span> <span>uniq</span> <span>-c</span>
    <span>196</span> Lens ID                         : AF-S DX Nikkor 35mm f<span>/</span>1.8G
   <span>1329</span> Lens ID                         : AF-S VR Zoom-Nikkor <span>24</span>-85mm f<span>/</span><span>3.5</span>-4.5G IF-ED
    <span>120</span> Lens ID                         : Tamron AF <span>18</span>-270mm f<span>/</span><span>3.5</span>-<span>6.3</span> Di II VC PZD <span>(</span>B008<span>)</span></pre></div>

<p>Dvs. jeg tog 1329 billeder med min Nikkor 24-85mm objektiv og "kun" 196 med min (fantastiske) Nikkor 35 mm, og 120 med Tamron.</p>

<p>En af de andre sjove ting er at se fordelingen af "Focal Length", dvs. zoom-niveau.</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">$ exiftool <span>*</span> <span>|</span> <span>grep</span> <span>"Focal Length"</span>
Focal Length                    : <span>24.0</span> mm
Min Focal Length                : <span>24.5</span> mm
Max Focal Length                : <span>84.8</span> mm
Focal Length In 35mm Format     : <span>36</span> mm
Focal Length                    : <span>24.0</span> mm <span>(</span><span>35</span> mm equivalent: <span>36.0</span> mm<span>)</span>
Focal Length                    : <span>24.0</span> mm
Min Focal Length                : <span>24.5</span> mm
Max Focal Length                : <span>84.8</span> mm
Focal Length In 35mm Format     : <span>36</span> mm
Focal Length                    : <span>24.0</span> mm <span>(</span><span>35</span> mm equivalent: <span>36.0</span> mm<span>)</span>
Focal Length                    : <span>24.0</span> mm
Min Focal Length                : <span>24.5</span> mm
Max Focal Length                : <span>84.8</span> mm
Focal Length In 35mm Format     : <span>36</span> mm
Focal Length                    : <span>24.0</span> mm <span>(</span><span>35</span> mm equivalent: <span>36.0</span> mm<span>)</span>
...</pre></div>

<p>Det var ikke helt godt nok - der kommer fem linier ud per billede med "Focal Length".  For at kræve at "Focal Length" står først på linjen laver jeg i stedet grep efter "^Focal Length" og med "grep -v equivalent" udelader jeg nu linjer med dette ord. Tilsvarende for linjerne med "In 35 mm Format:</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">$ exiftool <span>*</span> <span>|</span> <span>grep</span> <span>"^Focal Length"</span> <span>|</span> <span>grep</span> <span>-v</span> equivalent <span>|</span> <span>grep</span> <span>-v</span> <span>"In 35mm Format"</span>
Focal Length                    : <span>52.0</span> mm
Focal Length                    : <span>46.0</span> mm
Focal Length                    : <span>24.0</span> mm
Focal Length                    : <span>75.0</span> mm
Focal Length                    : <span>75.0</span> mm
...</pre></div>

<p>Endelig er jeg ved målet. Jeg klistrer en ekstra "sort" på for at sortere og en "uniq -c" for at tælle hvor mange unikke linier, der er.</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">exiftool <span>*</span> <span>|</span> <span>grep</span> <span>"^Focal Length"</span> <span>|</span> <span>grep</span> <span>-v</span> equivalent <span>|</span> <span>grep</span> <span>-v</span> <span>"In 35mm Format"</span> <span>|</span> <span>sort</span> <span>-n</span> <span>|</span> <span>uniq</span> <span>-c</span>
      <span>2</span> Focal Length                    : <span>110.0</span> mm
      <span>2</span> Focal Length                    : <span>130.0</span> mm
      <span>2</span> Focal Length                    : <span>140.0</span> mm
      <span>1</span> Focal Length                    : <span>170.0</span> mm
      <span>1</span> Focal Length                    : <span>18.0</span> mm
      <span>1</span> Focal Length                    : <span>185.0</span> mm
...</pre></div>

<p>Ikke godt nok. Det er noget rod, at 18 mm står mellem 170 og 185 mm.
Der skal lidt ekstra gymnastik med "cut -d : -f 2" for får det andet felt klippet ud med kolon som adskiller-tegn. 
og "mm" teksten kan slettes med "cut -d m -f 1" dvs. skil på "m" og tag det første del ud</p>

<div class="geshifilter"><pre class="bash geshifilter-bash">exiftool <span>*</span> <span>|</span> <span>grep</span> <span>"^Focal Length"</span> <span>|</span> <span>grep</span> <span>-v</span> equivalent <span>|</span> <span>grep</span> <span>-v</span> <span>"In 35mm Format"</span> <span>|</span> <span>cut</span> <span>-d</span> : <span>-f</span> <span>2</span> <span>|</span> <span>cut</span> <span>-d</span> m <span>-f</span> <span>1</span> <span>|</span> <span>sort</span> <span>-n</span> <span>|</span> <span>uniq</span> <span>-c</span>
     <span>1</span>  <span>18.0</span> 
      <span>6</span>  <span>23.0</span> 
    <span>288</span>  <span>24.0</span> 
     <span>11</span>  <span>26.0</span> 
      <span>4</span>  <span>27.0</span> 
     <span>15</span>  <span>28.0</span> 
     <span>24</span>  <span>29.0</span> 
      <span>2</span>  <span>30.0</span> 
     <span>15</span>  <span>31.0</span> 
     <span>68</span>  <span>32.0</span> 
     <span>36</span>  <span>34.0</span> 
    <span>225</span>  <span>35.0</span> 
     <span>34</span>  <span>36.0</span> 
     <span>42</span>  <span>38.0</span> 
     <span>75</span>  <span>40.0</span> 
     <span>60</span>  <span>42.0</span> 
     <span>21</span>  <span>44.0</span> 
     <span>31</span>  <span>45.0</span> 
     <span>67</span>  <span>46.0</span> 
     <span>74</span>  <span>48.0</span> 
     <span>58</span>  <span>50.0</span> 
     <span>93</span>  <span>52.0</span> 
     <span>40</span>  <span>55.0</span> 
     <span>41</span>  <span>56.0</span> 
     <span>52</span>  <span>58.0</span> 
      <span>1</span>  <span>60.0</span> 
     <span>47</span>  <span>62.0</span> 
     <span>24</span>  <span>65.0</span> 
     <span>22</span>  <span>66.0</span> 
     <span>14</span>  <span>68.0</span> 
     <span>16</span>  <span>70.0</span> 
     <span>20</span>  <span>72.0</span> 
     <span>11</span>  <span>75.0</span> 
     <span>11</span>  <span>78.0</span> 
     <span>21</span>  <span>80.0</span> 
     <span>55</span>  <span>85.0</span> 
      <span>1</span>  <span>92.0</span> 
      <span>2</span>  <span>110.0</span> 
      <span>2</span>  <span>130.0</span> 
      <span>2</span>  <span>140.0</span> 
      <span>1</span>  <span>170.0</span> 
      <span>1</span>  <span>185.0</span> 
      <span>1</span>  <span>220.0</span> 
     <span>10</span>  <span>270.0</span> </pre></div>

<p>Stort set alle skud er taget i området 24-70mm, og vil man have lidt mere detalje, så kan jeg bruge en af de mange kommando-linje statistik-pakker såsom <a href="https://raw.githubusercontent.com/bitly/data_hacks/master/data_hacks/histogram.py">histogram.py</a></p>

<div class="geshifilter"><pre class="bash geshifilter-bash">exiftool <span>*</span> <span>|</span> <span>grep</span> <span>"^Focal Length"</span> <span>|</span> <span>grep</span> <span>-v</span> equivalent <span>|</span> <span>grep</span> <span>-v</span> <span>"In 35mm Format"</span> <span>|</span> <span>cut</span> <span>-d</span> : <span>-f</span> <span>2</span> <span>|</span> <span>cut</span> <span>-d</span> m <span>-f</span> <span>1</span> <span>|</span> histogram.py
<span># NumSamples = 1645; Min = 18.00; Max = 270.00</span>
<span># Mean = 45.338602; Variance = 629.563768; SD = 25.091109; Median 40.000000</span>
<span># each ∎ represents a count of 12</span>
   <span>18.0000</span> -    <span>43.2000</span> <span>[</span>   <span>906</span><span>]</span>: ∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎
   <span>43.2000</span> -    <span>68.4000</span> <span>[</span>   <span>585</span><span>]</span>: ∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎∎
   <span>68.4000</span> -    <span>93.6000</span> <span>[</span>   <span>135</span><span>]</span>: ∎∎∎∎∎∎∎∎∎∎∎
   <span>93.6000</span> -   <span>118.8000</span> <span>[</span>     <span>2</span><span>]</span>: 
  <span>118.8000</span> -   <span>144.0000</span> <span>[</span>     <span>4</span><span>]</span>: 
  <span>144.0000</span> -   <span>169.2000</span> <span>[</span>     <span>0</span><span>]</span>: 
  <span>169.2000</span> -   <span>194.4000</span> <span>[</span>     <span>2</span><span>]</span>: 
  <span>194.4000</span> -   <span>219.6000</span> <span>[</span>     <span>0</span><span>]</span>: 
  <span>219.6000</span> -   <span>244.8000</span> <span>[</span>     <span>1</span><span>]</span>: 
  <span>244.8000</span> -   <span>270.0000</span> <span>[</span>    <span>10</span><span>]</span>: </pre></div>

<p>dvs en middelværdi på 45 mm for den afstand jeg nu var på karatekæmperne og lagt de fleste er taget i området 18-43 mm.</p>

<p>I får lige et billede til slut. Min datter Louise mod Melanie og jeg kan slet ikke få mit ben så højt op som Melanie kan :-)</p>

<p><figure class="plugin full zoomable"><img data-original-image="http://www.version2.dk/sites/v2/files/gk_dsc_2856.jpg" src="http://www.version2.dk/sites/v2/files/styles/article_620px_width/public/gk_dsc_2856.jpg?itok=U8_HNbZh" alt=""/></figure></p>

<p>/pto</p>

<p>P.S. Dette blog-indlæg kan med fordel læses sammen <a href="http://www.version2.dk/blog/effektiv-billedbehandling-paa-linux-kommandolinje-52514">med dette</a>.</p>
  </section></div></body></html>
