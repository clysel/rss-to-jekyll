---
layout:     post
title: 	    "Adware på Lenovo-maskiner kan misbruges af hackere til man-in-the-middle angreb"
post_author:	    Jakob Møllerhøj
post_date:	    Thu, 19 Feb 2015 15:04:00 +0000
post_site:	    www.version2.dk 
post_link:	    http://www.version2.dk/artikel/adware-paa-lenovo-maskiner-kan-misbruges-af-hackere-til-man-middle-angreb-80608?utm_medium=feed&utm_source=version2.dk&utm_campaign=it_nyheder
---
<html><body><div><section class="body"><p>Ikke alene har Lenovo i en periode leveret computere præinstalleret med, hvad der reelt set er adware, som tidligere omtalt på Version2. Den uønskede software, Superfish, fungerer på en måde, der gør computeren usikker i flere sammenhænge, og som reelt set sætter reklamer ind på hjemmesider via et man-in-the-middle angreb.</p>

<p>Det fortæller blandt andet sikkerhedseksperten Graham Cluely om på bloggen <a href="http://www.tripwire.com/state-of-security/security-data-protection/superfish-lenovo-adware-faq/">The State of Security</a>.</p>

<p>I <a href="http://news.lenovo.com/article_display.cfm?article_id=1929">en kort pressemeddelelse</a> skriver Lenovo, at selskabets egen undersøgelse af Superfish ikke har afsløret, at softwaren skulle være et sikkerhedsproblem. Lenovo svarer dog ikke direkte på det indirekte problem, som flere sikkerhedseksperter har påpeget, at Superfish efterlader i form af et usikkert certifikat.</p>

<p>Superfish fungerer ved at installere et selvsigneret rodcertifikat, som bruges til at opfange HTTPS-krypteret trafik. Således kan Superfish opfange den ellers krypterede trafik og indsætte reklamer i også krypteret kommunikation, når denne bliver vist i browseren.</p>

<p>Udover at Superfish altså opsnapper forbindelser, der skulle være sikre, så der kan sættes reklamer ind, inden forbindelsen sendes videre til browseren, så er nøglen bag selv-signerede Rodcertifikat på Lenovo-computeren af en svag karakter.</p>

<p>Der er tale om en RSA1024-bit nøgle, der brugt til at signere alle Superfish-certifikaterne, på de berørte computere.</p>

<p><a href="http://www.pcworld.com/article/2886612/lenovo-pcs-ship-with-adware-that-puts-computers-at-risk.html">Amerikanske PC World fortæller</a>, at en sådan nøgle i dag anses for at være kryptografisk usikker. PC World fortæller endvidere, at hvis det lykkes at finde frem til den private RSA-nøgle for rodcertifikatet, så vil man være i stand til at lave et man-in-the-middle angreb mod alle brugere, der har den sårbare software installeret.</p>

<p>Det skyldes, at det med RSA-nøglen vil være muligt for et website at udgive sig for at være et andet - eksempelvis en netbank - ved at præsentere sårbare systemer for et certifikat, som er underskrevet med rodcertifikatet.</p>

<p>»Det betyder, at Superfish kan generere et gyldigt (fra en browsers synspunkt) krypterings-certifikat for Facebook eller Google eller hvilket som helst andet site, der bruger HTTPS,« fortæller sikkerhedsekspert Andreas Lindh til <a href="http://www.forbes.com/sites/thomasbrewster/2015/02/19/superfish-need-to-know/">finanspublikationen Forbes</a>.</p>

<p>Det lader til at være mere end en teoretisk trussel. En bruger på Twitter, der kalder sig Yonathan Klijnsma, har netop lagt, hvad der ligger den private nøgle til Superfish-certifikatet ud.</p>

<p/><blockquote class="twitter-tweet"><p>Hey <a href="https://twitter.com/lenovo">@lenovo</a> I'm enjoying the <a href="https://twitter.com/hashtag/SuperFish?src=hash">#SuperFish</a> private key! Look at me ma' I'm a CA! <a href="http://t.co/GGkX4xJ9mQ">http://t.co/GGkX4xJ9mQ</a> <a href="http://t.co/va4cFc0y7T">pic.twitter.com/va4cFc0y7T</a></p>— Yonathan Klijnsma (@ydklijnsma) <a href="https://twitter.com/ydklijnsma/status/568390533749604352">February 19, 2015</a></blockquote>


<p>For at komme af med rod-certifikatet er det ifølge Graham Cluely ikke nok at afinstallere Superfish. Certifikatet skal fjernes manuelt også. Microsoft har lavet <a href="http://support.microsoft.com/kb/293819">en guide til fjernelse af rod-certifikater</a>.</p>

<p>Og her er <a href="http://support.microsoft.com/kb/293781">en liste over de officielle rodcertifikater i Windows</a>.</p>

<p>Lenovo-computere kommer siden januar 2015 ikke længere med Superfish. Det er uvist, hvor mange enheder der er derude, der indeholder Superfish.</p>

<p>De første meldinger om Superfish dukkede op i Lenovos supportforummer i september 2014, men det er først nu, sikkerhedseksperter har belyst problematikken.</p>
  </section></div></body></html>
